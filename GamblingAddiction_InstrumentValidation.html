<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Miguel Fudolig">

<title>Initiation and Sustenance of Quitting Gambling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="GamblingAddiction_InstrumentValidation_files/libs/clipboard/clipboard.min.js"></script>
<script src="GamblingAddiction_InstrumentValidation_files/libs/quarto-html/quarto.js"></script>
<script src="GamblingAddiction_InstrumentValidation_files/libs/quarto-html/popper.min.js"></script>
<script src="GamblingAddiction_InstrumentValidation_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="GamblingAddiction_InstrumentValidation_files/libs/quarto-html/anchor.min.js"></script>
<link href="GamblingAddiction_InstrumentValidation_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="GamblingAddiction_InstrumentValidation_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="GamblingAddiction_InstrumentValidation_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="GamblingAddiction_InstrumentValidation_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="GamblingAddiction_InstrumentValidation_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Initiation and Sustenance of Quitting Gambling</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Miguel Fudolig </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(semTools)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaanPlot)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidySEM)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(semPlot)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ltm)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="testing-measurement-invariance" class="level2">
<h2 class="anchored" data-anchor-id="testing-measurement-invariance">Testing Measurement Invariance</h2>
<p>We implement a measurement invariance analysis using the Confirmatory Factor Analysis to show that the instrument is valid across problem and non-problem gamblers. The CFA is related to the measurement side of the Structural Equation Modeling framework and is sufficient in proving instrument validity.</p>
</section>
<section id="loading-in-the-dataset" class="level2">
<h2 class="anchored" data-anchor-id="loading-in-the-dataset">Loading in the Dataset</h2>
<p>I am loading the recoded dataset that you provided me into R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>gambling <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Gambling behavior among college students_RECODED.csv"</span>) <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>gambling <span class="ot">&lt;-</span> gambling <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">Gambled =</span> <span class="fu">ifelse</span>(GambleD<span class="sc">==</span><span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I introduced a new variable named Gambled, where Gambled=0 corresponds to whether the participant gambled within the past 30 days. Else, Gambled=1.</p>
</section>
<section id="summary-statistics-of-the-scores" class="level2">
<h2 class="anchored" data-anchor-id="summary-statistics-of-the-scores">Summary statistics of the scores</h2>
<p>Let’s look at the summary statistics of the scores first.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>gambling <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="at">PA_mean =</span> <span class="fu">mean</span>(PA),</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">PA_sd =</span> <span class="fu">sd</span>(PA),</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">PA_median=</span><span class="fu">as.numeric</span>(<span class="fu">quantile</span>(PA,<span class="fl">0.5</span>)),</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">PAD_mean =</span> <span class="fu">mean</span>(PAD),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">PAD_sd =</span> <span class="fu">sd</span>(PAD),</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">PAD_median=</span><span class="fu">as.numeric</span>(<span class="fu">quantile</span>(PAD,<span class="fl">0.5</span>)),</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">PD_mean =</span> <span class="fu">mean</span>(PD),</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">PD_sd =</span> <span class="fu">sd</span>(PD),</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">PD_median=</span><span class="fu">as.numeric</span>(<span class="fu">quantile</span>(PD,<span class="fl">0.5</span>)),</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">BC_mean =</span> <span class="fu">mean</span>(BC),</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">BC_sd =</span> <span class="fu">sd</span>(BC),</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">BC_median=</span><span class="fu">as.numeric</span>(<span class="fu">quantile</span>(BC,<span class="fl">0.5</span>)),</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>                      <span class="at">CPE_mean =</span> <span class="fu">mean</span>(CPE),</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>                      <span class="at">CPE_sd =</span> <span class="fu">sd</span>(CPE),</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>                      <span class="at">CPE_median=</span><span class="fu">as.numeric</span>(<span class="fu">quantile</span>(CPE,<span class="fl">0.5</span>)),</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ET_mean =</span> <span class="fu">mean</span>(ET),</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ET_sd =</span> <span class="fu">sd</span>(ET),</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ET_median=</span><span class="fu">as.numeric</span>(<span class="fu">quantile</span>(ET,<span class="fl">0.5</span>)),</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>                      <span class="at">PfC_mean =</span> <span class="fu">mean</span>(PfC),</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>                      <span class="at">PfC_sd =</span> <span class="fu">sd</span>(PfC),</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>                      <span class="at">PfC_median=</span><span class="fu">as.numeric</span>(<span class="fu">quantile</span>(PfC,<span class="fl">0.5</span>)),</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>                      <span class="at">CSE_mean =</span> <span class="fu">mean</span>(CSE),</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>                      <span class="at">CSE_sd =</span> <span class="fu">sd</span>(CSE),</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>                      <span class="at">CSE_median=</span><span class="fu">as.numeric</span>(<span class="fu">quantile</span>(CSE,<span class="fl">0.5</span>)),</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Ini_mean =</span> <span class="fu">mean</span>(Ini),</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Ini_sd =</span> <span class="fu">sd</span>(Ini),</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Ini_median=</span><span class="fu">as.numeric</span>(<span class="fu">quantile</span>(Ini,<span class="fl">0.5</span>)),</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Sus_mean =</span> <span class="fu">mean</span>(Sus),</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Sus_sd =</span> <span class="fu">sd</span>(PA),</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Sus_median=</span><span class="fu">as.numeric</span>(<span class="fu">quantile</span>(Sus,<span class="fl">0.5</span>))</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>                      ) <span class="sc">|&gt;</span> </span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>,</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_prefix =</span> <span class="fu">c</span>(<span class="st">"pa"</span>,<span class="st">"pad"</span>,<span class="st">"bc"</span>,<span class="st">"cpe"</span>,<span class="st">"Ini"</span>,</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"et"</span>,<span class="st">"pfc"</span>,<span class="st">"cse"</span>,<span class="st">"Sus"</span>),</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to=</span> <span class="st">"SummaryStats"</span>,</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to=</span><span class="st">"Values"</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Values=</span><span class="fu">round</span>(Values,<span class="dv">2</span>)) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in gsub(vec_paste0("^", names_prefix), "", cols): argument 'pattern'
has length &gt; 1 and only the first element will be used</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   SummaryStats Values
1       PA_mean  13.75
2         PA_sd   5.83
3     PA_median  15.00
4      PAD_mean   3.92
5        PAD_sd   4.38
6    PAD_median   2.00
7       PD_mean   9.83
8         PD_sd   7.19
9     PD_median  10.00
10      BC_mean  16.01
11        BC_sd   4.49
12    BC_median  17.00
13     CPE_mean   6.93
14       CPE_sd   3.59
15   CPE_median   7.00
16      ET_mean  10.32
17        ET_sd   2.61
18    ET_median  12.00
19     PfC_mean   9.79
20       PfC_sd   2.81
21   PfC_median  11.00
22     CSE_mean   9.19
23       CSE_sd   3.19
24   CSE_median  10.00
25     Ini_mean   3.47
26       Ini_sd   1.09
27   Ini_median   4.00
28     Sus_mean   2.64
29       Sus_sd   5.83
30   Sus_median   3.00</code></pre>
</div>
</div>
</section>
<section id="cronbachs-alpha" class="level2">
<h2 class="anchored" data-anchor-id="cronbachs-alpha">Cronbach’s alpha</h2>
<p>We calculate Cronbach’s alpha for the responses using the <code>cronbach.alpha()</code> function in the package <code>ltm</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a> responses <span class="ot">&lt;-</span> gambling <span class="sc">|&gt;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="fu">c</span>(<span class="st">"pa"</span>,<span class="st">"pad"</span>,<span class="st">"bc"</span>,<span class="st">"cpe"</span>,<span class="st">"Ini"</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"et"</span>,<span class="st">"pfc"</span>,<span class="st">"cse"</span>,<span class="st">"Sus"</span>),<span class="at">ignore.case=</span>F))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cronbach.alpha</span>(responses,<span class="at">CI=</span>T,<span class="at">standardized =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Standardized Cronbach's alpha for the 'responses' data-set

Items: 29
Sample units: 1474
alpha: 0.883

Bootstrap 95% CI based on 1000 samples
 2.5% 97.5% 
0.871 0.893 </code></pre>
</div>
</div>
<p>Overall Cronbach’s alpha is estimated to be 0.883 (95% CI=(0.872,0.893)) higher than 0.70, which leads us to conclude that the instrument is acceptable.</p>
<p>We then look at the specific Cronbach’s alphas for each construct.</p>
<section id="perceived-advantage" class="level3">
<h3 class="anchored" data-anchor-id="perceived-advantage">Perceived Advantage</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>gambling <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"pa"</span>,<span class="at">ignore.case=</span>F) <span class="sc">&amp;!</span><span class="fu">starts_with</span>(<span class="st">"pad"</span>)) <span class="sc">|&gt;</span> <span class="fu">alpha</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Reliability analysis   
Call: alpha(x = dplyr::select(gambling, starts_with("pa", ignore.case = F) &amp; 
    !starts_with("pad")))

  raw_alpha std.alpha G6(smc) average_r S/N    ase mean  sd median_r
      0.93      0.93    0.92      0.71  12 0.0029  2.7 1.2     0.73

    95% confidence boundaries 
         lower alpha upper
Feldt     0.92  0.93  0.93
Duhachek  0.92  0.93  0.93

 Reliability if an item is dropped:
    raw_alpha std.alpha G6(smc) average_r  S/N alpha se  var.r med.r
pa1      0.91      0.91    0.90      0.71  9.9   0.0037 0.0157  0.71
pa2      0.93      0.93    0.92      0.77 13.8   0.0029 0.0039  0.76
pa3      0.89      0.89    0.87      0.68  8.4   0.0043 0.0069  0.69
pa4      0.90      0.90    0.88      0.69  8.8   0.0042 0.0062  0.70
pa5      0.91      0.91    0.90      0.71  9.9   0.0038 0.0102  0.69

 Item statistics 
       n raw.r std.r r.cor r.drop mean  sd
pa1 1474  0.88  0.88  0.84   0.81  2.7 1.3
pa2 1474  0.77  0.79  0.71   0.68  3.4 1.1
pa3 1474  0.93  0.93  0.92   0.88  2.7 1.4
pa4 1474  0.92  0.91  0.91   0.87  2.6 1.4
pa5 1474  0.89  0.88  0.84   0.81  2.4 1.5

Non missing response frequency for each item
       0    1    2    3    4 miss
pa1 0.11 0.07 0.23 0.23 0.36    0
pa2 0.04 0.03 0.10 0.16 0.66    0
pa3 0.11 0.09 0.22 0.20 0.39    0
pa4 0.12 0.10 0.21 0.18 0.38    0
pa5 0.17 0.10 0.20 0.17 0.35    0</code></pre>
</div>
</div>
</section>
<section id="perceived-disadvantage" class="level3">
<h3 class="anchored" data-anchor-id="perceived-disadvantage">Perceived Disadvantage</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>gambling <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"pad"</span>,<span class="at">ignore.case=</span>F) ) <span class="sc">|&gt;</span> <span class="fu">alpha</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Reliability analysis   
Call: alpha(x = dplyr::select(gambling, starts_with("pad", ignore.case = F)))

  raw_alpha std.alpha G6(smc) average_r S/N    ase mean   sd median_r
      0.88      0.89    0.88      0.61 7.7 0.0049 0.78 0.88     0.66

    95% confidence boundaries 
         lower alpha upper
Feldt     0.87  0.88  0.89
Duhachek  0.87  0.88  0.89

 Reliability if an item is dropped:
     raw_alpha std.alpha G6(smc) average_r S/N alpha se  var.r med.r
pad1      0.90      0.90    0.88      0.70 9.1   0.0044 0.0028  0.68
pad2      0.84      0.85    0.83      0.59 5.7   0.0068 0.0229  0.58
pad3      0.85      0.85    0.82      0.59 5.7   0.0064 0.0127  0.60
pad4      0.84      0.85    0.84      0.59 5.7   0.0068 0.0220  0.60
pad5      0.84      0.85    0.82      0.58 5.5   0.0066 0.0111  0.59

 Item statistics 
        n raw.r std.r r.cor r.drop mean   sd
pad1 1474  0.71  0.70  0.57   0.54 1.05 1.10
pad2 1474  0.86  0.86  0.81   0.77 0.83 1.09
pad3 1474  0.84  0.86  0.83   0.76 0.51 0.89
pad4 1474  0.87  0.86  0.81   0.76 0.93 1.21
pad5 1474  0.86  0.87  0.85   0.77 0.60 0.99

Non missing response frequency for each item
        0    1    2    3    4 miss
pad1 0.42 0.24 0.24 0.07 0.03    0
pad2 0.55 0.19 0.17 0.06 0.03    0
pad3 0.69 0.16 0.10 0.03 0.02    0
pad4 0.54 0.16 0.16 0.09 0.05    0
pad5 0.66 0.16 0.11 0.04 0.02    0</code></pre>
</div>
</div>
</section>
<section id="behavioral-confidence" class="level3">
<h3 class="anchored" data-anchor-id="behavioral-confidence">Behavioral Confidence</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>gambling <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"bc"</span>,<span class="at">ignore.case=</span>F) ) <span class="sc">|&gt;</span> <span class="fu">alpha</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Reliability analysis   
Call: alpha(x = dplyr::select(gambling, starts_with("bc", ignore.case = F)))

  raw_alpha std.alpha G6(smc) average_r S/N   ase mean  sd median_r
       0.9       0.9    0.89      0.65 9.1 0.004  3.2 0.9     0.64

    95% confidence boundaries 
         lower alpha upper
Feldt     0.89   0.9  0.91
Duhachek  0.89   0.9  0.91

 Reliability if an item is dropped:
    raw_alpha std.alpha G6(smc) average_r S/N alpha se  var.r med.r
bc1      0.90      0.90    0.88      0.69 8.9   0.0043 0.0039  0.67
bc2      0.86      0.86    0.84      0.61 6.4   0.0058 0.0049  0.64
bc3      0.86      0.87    0.84      0.62 6.5   0.0055 0.0073  0.62
bc4      0.88      0.88    0.86      0.66 7.6   0.0047 0.0117  0.66
bc5      0.88      0.88    0.86      0.65 7.5   0.0049 0.0045  0.63

 Item statistics 
       n raw.r std.r r.cor r.drop mean   sd
bc1 1474  0.75  0.78  0.70   0.66  3.6 0.81
bc2 1474  0.90  0.89  0.87   0.83  3.0 1.15
bc3 1474  0.89  0.89  0.86   0.81  3.3 1.05
bc4 1474  0.83  0.83  0.77   0.73  3.3 1.03
bc5 1474  0.86  0.84  0.79   0.75  2.8 1.24

Non missing response frequency for each item
       0    1    2    3    4 miss
bc1 0.01 0.02 0.06 0.16 0.74    0
bc2 0.04 0.08 0.17 0.22 0.49    0
bc3 0.03 0.06 0.11 0.23 0.57    0
bc4 0.02 0.06 0.12 0.19 0.61    0
bc5 0.06 0.10 0.23 0.20 0.41    0</code></pre>
</div>
</div>
</section>
<section id="changes-in-physical-environment" class="level3">
<h3 class="anchored" data-anchor-id="changes-in-physical-environment">Changes in Physical Environment</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>gambling <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"cpe"</span>,<span class="at">ignore.case=</span>F) ) <span class="sc">|&gt;</span> <span class="fu">alpha</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Reliability analysis   
Call: alpha(x = dplyr::select(gambling, starts_with("cpe", ignore.case = F)))

  raw_alpha std.alpha G6(smc) average_r S/N  ase mean  sd median_r
      0.77      0.77    0.72      0.52 3.3 0.01  2.3 1.2     0.44

    95% confidence boundaries 
         lower alpha upper
Feldt     0.75  0.77  0.79
Duhachek  0.75  0.77  0.79

 Reliability if an item is dropped:
     raw_alpha std.alpha G6(smc) average_r S/N alpha se var.r med.r
cpe1      0.60      0.61    0.44      0.44 1.5   0.0204    NA  0.44
cpe2      0.56      0.57    0.40      0.40 1.3   0.0223    NA  0.40
cpe3      0.84      0.84    0.73      0.73 5.4   0.0082    NA  0.73

 Item statistics 
        n raw.r std.r r.cor r.drop mean  sd
cpe1 1474  0.88  0.86  0.79   0.68  2.1 1.6
cpe2 1474  0.89  0.87  0.82   0.71  1.9 1.5
cpe3 1474  0.71  0.74  0.49   0.45  2.9 1.3

Non missing response frequency for each item
        0    1    2    3    4 miss
cpe1 0.26 0.11 0.19 0.14 0.30    0
cpe2 0.26 0.15 0.23 0.15 0.22    0
cpe3 0.08 0.08 0.16 0.24 0.45    0</code></pre>
</div>
</div>
</section>
<section id="entire-initiation-scale" class="level3">
<h3 class="anchored" data-anchor-id="entire-initiation-scale">Entire Initiation Scale</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>gambling <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="fu">c</span>(<span class="st">"pa"</span>,<span class="st">"pad"</span>,<span class="st">"bc"</span>,<span class="st">"cpe"</span>,<span class="st">"Ini"</span>),<span class="at">ignore.case=</span>F)) <span class="sc">|&gt;</span> <span class="fu">alpha</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in alpha(dplyr::select(gambling, starts_with(c("pa", "pad", "bc", : Some items were negatively correlated with the total scale and probably 
should be reversed.  
To do this, run the function again with the 'check.keys=TRUE' option</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Some items ( pad1 pad2 pad3 pad4 pad5 ) were negatively correlated with the total scale and 
probably should be reversed.  
To do this, run the function again with the 'check.keys=TRUE' option</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Reliability analysis   
Call: alpha(x = dplyr::select(gambling, starts_with(c("pa", "pad", 
    "bc", "cpe", "Ini"), ignore.case = F)))

  raw_alpha std.alpha G6(smc) average_r S/N    ase mean   sd median_r
       0.8       0.8    0.91      0.17   4 0.0073  2.3 0.57     0.15

    95% confidence boundaries 
         lower alpha upper
Feldt     0.79   0.8  0.82
Duhachek  0.79   0.8  0.82

 Reliability if an item is dropped:
     raw_alpha std.alpha G6(smc) average_r S/N alpha se var.r med.r
pa1       0.78      0.78    0.90      0.16 3.5   0.0082 0.091  0.14
pa2       0.79      0.79    0.90      0.17 3.7   0.0078 0.094  0.15
pa3       0.78      0.78    0.89      0.16 3.5   0.0083 0.090  0.14
pa4       0.78      0.78    0.89      0.16 3.5   0.0083 0.090  0.14
pa5       0.78      0.78    0.89      0.16 3.5   0.0084 0.091  0.14
pad1      0.82      0.81    0.91      0.19 4.3   0.0069 0.087  0.16
pad2      0.81      0.80    0.91      0.19 4.1   0.0070 0.085  0.16
pad3      0.80      0.80    0.90      0.18 3.9   0.0073 0.089  0.16
pad4      0.82      0.81    0.91      0.19 4.2   0.0068 0.083  0.16
pad5      0.80      0.80    0.90      0.18 4.0   0.0072 0.088  0.16
bc1       0.80      0.79    0.90      0.17 3.7   0.0076 0.089  0.13
bc2       0.79      0.78    0.89      0.17 3.6   0.0079 0.087  0.14
bc3       0.79      0.78    0.90      0.17 3.6   0.0078 0.087  0.14
bc4       0.80      0.79    0.90      0.17 3.7   0.0076 0.087  0.14
bc5       0.79      0.78    0.90      0.17 3.6   0.0079 0.089  0.14
cpe1      0.80      0.79    0.90      0.17 3.8   0.0075 0.096  0.15
cpe2      0.80      0.79    0.90      0.17 3.7   0.0077 0.096  0.14
cpe3      0.79      0.78    0.90      0.17 3.6   0.0080 0.090  0.14
Ini       0.80      0.79    0.90      0.17 3.8   0.0077 0.094  0.13

 Item statistics 
        n raw.r std.r r.cor r.drop mean   sd
pa1  1474 0.649  0.62 0.613  0.569 2.68 1.32
pa2  1474 0.521  0.51 0.482  0.444 3.37 1.06
pa3  1474 0.678  0.65 0.659  0.601 2.67 1.35
pa4  1474 0.684  0.65 0.662  0.605 2.60 1.40
pa5  1474 0.691  0.66 0.656  0.609 2.43 1.48
pad1 1474 0.084  0.11 0.038 -0.018 1.05 1.10
pad2 1474 0.203  0.23 0.196  0.103 0.83 1.09
pad3 1474 0.298  0.34 0.318  0.220 0.51 0.89
pad4 1474 0.131  0.16 0.123  0.019 0.93 1.21
pad5 1474 0.291  0.33 0.311  0.203 0.60 0.99
bc1  1474 0.448  0.48 0.446  0.385 3.60 0.81
bc2  1474 0.553  0.57 0.566  0.472 3.04 1.15
bc3  1474 0.537  0.56 0.550  0.462 3.26 1.05
bc4  1474 0.446  0.47 0.438  0.364 3.31 1.03
bc5  1474 0.557  0.56 0.551  0.470 2.80 1.24
cpe1 1474 0.481  0.44 0.410  0.357 2.11 1.57
cpe2 1474 0.505  0.47 0.437  0.392 1.93 1.48
cpe3 1474 0.578  0.57 0.538  0.492 2.89 1.27
Ini  1474 0.454  0.46 0.407  0.369 3.47 1.09

Non missing response frequency for each item
        0    1    2    3    4 miss
pa1  0.11 0.07 0.23 0.23 0.36    0
pa2  0.04 0.03 0.10 0.16 0.66    0
pa3  0.11 0.09 0.22 0.20 0.39    0
pa4  0.12 0.10 0.21 0.18 0.38    0
pa5  0.17 0.10 0.20 0.17 0.35    0
pad1 0.42 0.24 0.24 0.07 0.03    0
pad2 0.55 0.19 0.17 0.06 0.03    0
pad3 0.69 0.16 0.10 0.03 0.02    0
pad4 0.54 0.16 0.16 0.09 0.05    0
pad5 0.66 0.16 0.11 0.04 0.02    0
bc1  0.01 0.02 0.06 0.16 0.74    0
bc2  0.04 0.08 0.17 0.22 0.49    0
bc3  0.03 0.06 0.11 0.23 0.57    0
bc4  0.02 0.06 0.12 0.19 0.61    0
bc5  0.06 0.10 0.23 0.20 0.41    0
cpe1 0.26 0.11 0.19 0.14 0.30    0
cpe2 0.26 0.15 0.23 0.15 0.22    0
cpe3 0.08 0.08 0.16 0.24 0.45    0
Ini  0.05 0.03 0.06 0.11 0.75    0</code></pre>
</div>
</div>
</section>
<section id="emotional-transformation" class="level3">
<h3 class="anchored" data-anchor-id="emotional-transformation">Emotional Transformation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>gambling <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"et"</span>,<span class="at">ignore.case=</span>F) ) <span class="sc">|&gt;</span> <span class="fu">alpha</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Reliability analysis   
Call: alpha(x = dplyr::select(gambling, starts_with("et", ignore.case = F)))

  raw_alpha std.alpha G6(smc) average_r S/N    ase mean   sd median_r
      0.92      0.92    0.89       0.8  12 0.0035  3.4 0.87     0.81

    95% confidence boundaries 
         lower alpha upper
Feldt     0.91  0.92  0.93
Duhachek  0.91  0.92  0.93

 Reliability if an item is dropped:
    raw_alpha std.alpha G6(smc) average_r  S/N alpha se var.r med.r
et1      0.91      0.91    0.84      0.84 10.2   0.0047    NA  0.84
et2      0.86      0.87    0.77      0.77  6.5   0.0070    NA  0.77
et3      0.89      0.89    0.81      0.81  8.3   0.0057    NA  0.81

 Item statistics 
       n raw.r std.r r.cor r.drop mean   sd
et1 1474  0.93  0.92  0.85   0.82  3.4 1.01
et2 1474  0.94  0.94  0.91   0.87  3.5 0.89
et3 1474  0.93  0.93  0.88   0.84  3.5 0.91

Non missing response frequency for each item
       0    1    2    3    4 miss
et1 0.03 0.04 0.11 0.19 0.63    0
et2 0.02 0.02 0.08 0.19 0.68    0
et3 0.02 0.03 0.09 0.18 0.68    0</code></pre>
</div>
</div>
</section>
<section id="practice-for-change" class="level3">
<h3 class="anchored" data-anchor-id="practice-for-change">Practice for Change</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>gambling <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"pfc"</span>,<span class="at">ignore.case=</span>F) ) <span class="sc">|&gt;</span> <span class="fu">alpha</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Reliability analysis   
Call: alpha(x = dplyr::select(gambling, starts_with("pfc", ignore.case = F)))

  raw_alpha std.alpha G6(smc) average_r S/N    ase mean   sd median_r
      0.83      0.85     0.8      0.65 5.6 0.0076  3.3 0.94     0.62

    95% confidence boundaries 
         lower alpha upper
Feldt     0.82  0.83  0.85
Duhachek  0.82  0.83  0.85

 Reliability if an item is dropped:
     raw_alpha std.alpha G6(smc) average_r S/N alpha se var.r med.r
pfc1      0.87      0.87    0.77      0.77 6.5   0.0069    NA  0.77
pfc2      0.71      0.72    0.57      0.57 2.6   0.0145    NA  0.57
pfc3      0.75      0.77    0.62      0.62 3.3   0.0123    NA  0.62

 Item statistics 
        n raw.r std.r r.cor r.drop mean   sd
pfc1 1474  0.86  0.83  0.68   0.63  3.1 1.26
pfc2 1474  0.89  0.91  0.86   0.77  3.4 0.95
pfc3 1474  0.87  0.89  0.82   0.72  3.3 1.00

Non missing response frequency for each item
        0    1    2    3    4 miss
pfc1 0.08 0.06 0.13 0.18 0.56    0
pfc2 0.02 0.04 0.12 0.22 0.61    0
pfc3 0.02 0.04 0.12 0.20 0.61    0</code></pre>
</div>
</div>
</section>
<section id="changes-in-the-social-environment" class="level3">
<h3 class="anchored" data-anchor-id="changes-in-the-social-environment">Changes in the social environment</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>gambling <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"cse"</span>,<span class="at">ignore.case=</span>F) ) <span class="sc">|&gt;</span> <span class="fu">alpha</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Reliability analysis   
Call: alpha(x = dplyr::select(gambling, starts_with("cse", ignore.case = F)))

  raw_alpha std.alpha G6(smc) average_r S/N    ase mean  sd median_r
       0.8      0.81    0.76      0.58 4.2 0.0092  3.1 1.1     0.52

    95% confidence boundaries 
         lower alpha upper
Feldt     0.78   0.8  0.82
Duhachek  0.78   0.8  0.82

 Reliability if an item is dropped:
     raw_alpha std.alpha G6(smc) average_r S/N alpha se var.r med.r
cse1      0.68      0.68    0.52      0.52 2.2   0.0164    NA  0.52
cse2      0.66      0.66    0.50      0.50 2.0   0.0175    NA  0.50
cse3      0.85      0.85    0.74      0.74 5.6   0.0079    NA  0.74

 Item statistics 
        n raw.r std.r r.cor r.drop mean  sd
cse1 1474  0.87  0.88  0.81   0.70  3.2 1.2
cse2 1474  0.87  0.88  0.82   0.72  3.2 1.2
cse3 1474  0.81  0.79  0.59   0.55  2.9 1.4

Non missing response frequency for each item
        0    1    2    3    4 miss
cse1 0.07 0.05 0.12 0.16 0.59    0
cse2 0.05 0.06 0.14 0.18 0.57    0
cse3 0.09 0.09 0.18 0.15 0.49    0</code></pre>
</div>
</div>
</section>
<section id="overall-sustenance" class="level3">
<h3 class="anchored" data-anchor-id="overall-sustenance">Overall sustenance</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>gambling <span class="sc">|&gt;</span>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="fu">c</span>(<span class="st">"et"</span>,<span class="st">"pfc"</span>,<span class="st">"cse"</span>,<span class="st">"Sus"</span>),<span class="at">ignore.case=</span>F)) <span class="sc">|&gt;</span> <span class="fu">alpha</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Reliability analysis   
Call: alpha(x = dplyr::select(gambling, starts_with(c("et", "pfc", 
    "cse", "Sus"), ignore.case = F)))

  raw_alpha std.alpha G6(smc) average_r S/N    ase mean   sd median_r
      0.89       0.9    0.92      0.49 9.5 0.0044  3.2 0.81     0.43

    95% confidence boundaries 
         lower alpha upper
Feldt     0.88  0.89   0.9
Duhachek  0.88  0.89   0.9

 Reliability if an item is dropped:
     raw_alpha std.alpha G6(smc) average_r  S/N alpha se var.r med.r
et1       0.87      0.89    0.91      0.47  8.0   0.0051 0.025  0.43
et2       0.87      0.89    0.90      0.47  7.9   0.0051 0.023  0.43
et3       0.87      0.89    0.90      0.47  7.8   0.0051 0.024  0.42
pfc1      0.88      0.90    0.91      0.49  8.6   0.0050 0.031  0.43
pfc2      0.87      0.89    0.90      0.47  7.8   0.0052 0.025  0.43
pfc3      0.87      0.89    0.91      0.47  8.1   0.0051 0.027  0.43
cse1      0.88      0.90    0.91      0.50  8.9   0.0048 0.029  0.44
cse2      0.88      0.90    0.91      0.49  8.8   0.0049 0.029  0.42
cse3      0.89      0.90    0.92      0.51  9.5   0.0045 0.027  0.45
Sus       0.90      0.91    0.93      0.53 10.2   0.0040 0.022  0.48

 Item statistics 
        n raw.r std.r r.cor r.drop mean   sd
et1  1474  0.79  0.81  0.80   0.73  3.4 1.01
et2  1474  0.81  0.83  0.84   0.76  3.5 0.89
et3  1474  0.81  0.84  0.84   0.77  3.5 0.91
pfc1 1474  0.73  0.72  0.68   0.65  3.1 1.26
pfc2 1474  0.82  0.84  0.83   0.77  3.4 0.95
pfc3 1474  0.78  0.80  0.78   0.72  3.3 1.00
cse1 1474  0.70  0.68  0.65   0.60  3.2 1.23
cse2 1474  0.71  0.70  0.67   0.63  3.2 1.17
cse3 1474  0.63  0.60  0.53   0.51  2.9 1.36
Sus  1474  0.55  0.52  0.42   0.40  2.6 1.47

Non missing response frequency for each item
        0    1    2    3    4 miss
et1  0.03 0.04 0.11 0.19 0.63    0
et2  0.02 0.02 0.08 0.19 0.68    0
et3  0.02 0.03 0.09 0.18 0.68    0
pfc1 0.08 0.06 0.13 0.18 0.56    0
pfc2 0.02 0.04 0.12 0.22 0.61    0
pfc3 0.02 0.04 0.12 0.20 0.61    0
cse1 0.07 0.05 0.12 0.16 0.59    0
cse2 0.05 0.06 0.14 0.18 0.57    0
cse3 0.09 0.09 0.18 0.15 0.49    0
Sus  0.16 0.08 0.14 0.22 0.41    0</code></pre>
</div>
</div>
</section>
</section>
<section id="cfa-and-sem-analysis" class="level1">
<h1>CFA and SEM Analysis</h1>
<section id="initiation-of-quitting-gambling" class="level2">
<h2 class="anchored" data-anchor-id="initiation-of-quitting-gambling">Initiation of quitting gambling</h2>
<p>We now check for correlations between the items for initiation of quitting gambling.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #| echo: false</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a> cormat <span class="ot">&lt;-</span> gambling <span class="sc">|&gt;</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="fu">c</span>(<span class="st">"pa"</span>,<span class="st">"pad"</span>,<span class="st">"bc"</span>,<span class="st">"cpe"</span>,<span class="st">"Ini"</span>),<span class="at">ignore.case=</span>F)) <span class="sc">|&gt;</span>   <span class="fu">cor</span>()</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cormat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GamblingAddiction_InstrumentValidation_files/figure-html/corr-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We now use the <code>lavaan</code> package to estimate a multi-group CFA by grouping each construct.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>inimod <span class="ot">&lt;-</span> <span class="st">'pa =~ pa1 + pa2 +pa3+pa4 + pa5</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="st">                pad =~ pad1 + pad2 + pad3 + pad4 + pad5</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="st">                bc =~ bc1 + bc2 + bc3 + bc4 + bc5</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="st">                ini=~ Ini'</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>CFAfit_ini <span class="ot">&lt;-</span> <span class="fu">cfa</span>(inimod,<span class="at">data=</span>gambling,<span class="at">meanstructure=</span>T,<span class="at">mimic=</span><span class="st">"Mplus"</span>,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">estimator=</span><span class="st">"MLM"</span>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>CFAfit_ini <span class="sc">|&gt;</span> <span class="fu">summary</span>(<span class="at">fit.measures=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.15 ended normally after 40 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        53

  Number of observations                          1474

Model Test User Model:
                                               Standard      Scaled
  Test Statistic                               1188.264     882.537
  Degrees of freedom                                 99          99
  P-value (Chi-square)                            0.000       0.000
  Scaling correction factor                                   1.346
    Satorra-Bentler correction (Mplus variant)                     

Model Test Baseline Model:

  Test statistic                             16484.666   12286.495
  Degrees of freedom                               120         120
  P-value                                        0.000       0.000
  Scaling correction factor                                  1.342

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.933       0.936
  Tucker-Lewis Index (TLI)                       0.919       0.922
                                                                  
  Robust Comparative Fit Index (CFI)                         0.935
  Robust Tucker-Lewis Index (TLI)                            0.922

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -28649.358  -28649.358
  Loglikelihood unrestricted model (H1)     -28055.226  -28055.226
                                                                  
  Akaike (AIC)                               57404.716   57404.716
  Bayesian (BIC)                             57685.390   57685.390
  Sample-size adjusted Bayesian (SABIC)      57517.025   57517.025

Root Mean Square Error of Approximation:

  RMSEA                                          0.086       0.073
  90 Percent confidence interval - lower         0.082       0.069
  90 Percent confidence interval - upper         0.091       0.077
  P-value H_0: RMSEA &lt;= 0.050                    0.000       0.000
  P-value H_0: RMSEA &gt;= 0.080                    0.992       0.002
                                                                  
  Robust RMSEA                                               0.085
  90 Percent confidence interval - lower                     0.080
  90 Percent confidence interval - upper                     0.090
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.000
  P-value H_0: Robust RMSEA &gt;= 0.080                         0.947

Standardized Root Mean Square Residual:

  SRMR                                           0.054       0.054

Parameter Estimates:

  Standard errors                           Robust.sem
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  pa =~                                               
    pa1               1.000                           
    pa2               0.691    0.025   27.279    0.000
    pa3               1.207    0.026   46.297    0.000
    pa4               1.233    0.028   44.716    0.000
    pa5               1.174    0.027   43.278    0.000
  pad =~                                              
    pad1              1.000                           
    pad2              1.433    0.067   21.246    0.000
    pad3              1.241    0.061   20.344    0.000
    pad4              1.595    0.072   22.109    0.000
    pad5              1.406    0.070   20.181    0.000
  bc =~                                               
    bc1               1.000                           
    bc2               1.790    0.082   21.880    0.000
    bc3               1.606    0.069   23.419    0.000
    bc4               1.370    0.061   22.580    0.000
    bc5               1.739    0.092   18.909    0.000
  ini =~                                              
    Ini               1.000                           

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  pa ~~                                               
    pad               0.032    0.016    1.976    0.048
    bc                0.137    0.020    6.904    0.000
    ini               0.336    0.034   10.002    0.000
  pad ~~                                              
    bc               -0.100    0.013   -7.651    0.000
    ini              -0.136    0.021   -6.599    0.000
  bc ~~                                               
    ini               0.282    0.031    9.188    0.000

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .pa1               2.676    0.034   78.027    0.000
   .pa2               3.373    0.028  121.712    0.000
   .pa3               2.669    0.035   75.816    0.000
   .pa4               2.602    0.036   71.470    0.000
   .pa5               2.429    0.039   63.017    0.000
   .pad1              1.045    0.029   36.464    0.000
   .pad2              0.830    0.028   29.150    0.000
   .pad3              0.505    0.023   21.702    0.000
   .pad4              0.934    0.032   29.597    0.000
   .pad5              0.603    0.026   23.308    0.000
   .bc1               3.599    0.021  171.393    0.000
   .bc2               3.040    0.030  101.251    0.000
   .bc3               3.259    0.027  119.467    0.000
   .bc4               3.307    0.027  123.505    0.000
   .bc5               2.803    0.032   86.751    0.000
   .Ini               3.468    0.028  122.586    0.000
    pa                0.000                           
    pad               0.000                           
    bc                0.000                           
    ini               0.000                           

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .pa1               0.615    0.030   20.300    0.000
   .pa2               0.598    0.025   23.748    0.000
   .pa3               0.199    0.019   10.298    0.000
   .pa4               0.253    0.026    9.836    0.000
   .pa5               0.651    0.038   17.149    0.000
   .pad1              0.833    0.039   21.148    0.000
   .pad2              0.417    0.029   14.397    0.000
   .pad3              0.217    0.017   12.580    0.000
   .pad4              0.506    0.031   16.432    0.000
   .pad5              0.239    0.024   10.089    0.000
   .bc1               0.325    0.022   14.773    0.000
   .bc2               0.289    0.023   12.693    0.000
   .bc3               0.259    0.021   12.480    0.000
   .bc4               0.447    0.024   18.302    0.000
   .bc5               0.556    0.032   17.514    0.000
   .Ini               0.000                           
    pa                1.118    0.059   18.832    0.000
    pad               0.378    0.035   10.718    0.000
    bc                0.325    0.035    9.312    0.000
    ini               1.180    0.064   18.446    0.000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>cfasem_ini <span class="ot">&lt;-</span> <span class="fu">sem</span>(inimod,<span class="at">data=</span>gambling)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lavaanPlot</span>(<span class="at">model=</span>cfasem_ini,<span class="at">coefs =</span> <span class="cn">TRUE</span>, <span class="at">stand =</span> <span class="cn">TRUE</span>, <span class="at">sig =</span> <span class="fl">0.05</span>) <span class="ot">-&gt;</span> lpsem</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">save_png</span>(lpsem,<span class="st">"sem_ini_nogroups.png"</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(CFAfit_ini,<span class="at">what=</span><span class="st">"diagram"</span>,<span class="st">"std"</span>,<span class="at">layout=</span><span class="st">"tree"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GamblingAddiction_InstrumentValidation_files/figure-html/construct-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The important fit measures are the following: RMSEA, SRMR, and CFI. For an accetable fit, the following conditions should be satisfied: RMSEA values of <span class="math inline">\(\leq\)</span> 0.06, CFI values close to 1, and SRMR values less than 0.10. The overall model seems to satisfy the CFI and SRMR criteria, but not the RMSEA. However, there are some sources that say that RMSEA below 0.10 is still acceptable.</p>
</section>
<section id="construct-validity-convergent-and-discriminant-validity" class="level2">
<h2 class="anchored" data-anchor-id="construct-validity-convergent-and-discriminant-validity">Construct Validity (Convergent and Discriminant Validity)</h2>
<p>We check convergent and discriminant validity by looking at the AVE (average variance extracted) for convergent validity and CR (composite reliability) for discriminant validity.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>CFAfit_ini <span class="sc">|&gt;</span> <span class="fu">compRelSEM</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   pa   pad    bc 
0.925 0.880 0.908 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>CFAfit_ini <span class="sc">|&gt;</span> semTools<span class="sc">::</span><span class="fu">reliability</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              pa       pad        bc
alpha  0.9251719 0.8807793 0.8983117
omega  0.9313660 0.8840525 0.9069719
omega2 0.9313660 0.8840525 0.9069719
omega3 0.9249504 0.8798350 0.9075453
avevar 0.7377028 0.6093313 0.6691427</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>CFAfit_ini <span class="sc">|&gt;</span> <span class="fu">AVE</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   pa   pad    bc 
0.738 0.609 0.669 </code></pre>
</div>
</div>
</section>
<section id="configural-invariance" class="level2">
<h2 class="anchored" data-anchor-id="configural-invariance">Configural Invariance</h2>
<p>Let us now see if we have configural invariance between the non-gambling and gambling groups.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>cfa.config <span class="ot">&lt;-</span> <span class="fu">cfa</span>(inimod,<span class="at">data=</span>gambling,<span class="at">group=</span><span class="st">"Gambled"</span>,<span class="at">mimic=</span><span class="st">"Mplus"</span>,</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">estimator=</span><span class="st">"MLM"</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>cfa.config <span class="sc">|&gt;</span> <span class="fu">summary</span>(<span class="at">fit.measures=</span>T,<span class="at">standardized=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.15 ended normally after 72 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                       110
  Number of equality constraints                    28

  Number of observations per group:                   
    1                                              562
    0                                              912

Model Test User Model:
                                               Standard      Scaled
  Test Statistic                               1435.360    1113.215
  Degrees of freedom                                222         222
  P-value (Chi-square)                            0.000       0.000
  Scaling correction factor                                   1.289
    Satorra-Bentler correction (Mplus variant)                     
  Test statistic for each group:
    1                                          683.083     529.775
    0                                          752.277     583.440

Model Test Baseline Model:

  Test statistic                             15718.522   11918.321
  Degrees of freedom                               240         240
  P-value                                        0.000       0.000
  Scaling correction factor                                  1.319

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.922       0.924
  Tucker-Lewis Index (TLI)                       0.915       0.917
                                                                  
  Robust Comparative Fit Index (CFI)                         0.925
  Robust Tucker-Lewis Index (TLI)                            0.919

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -28060.875  -28060.875
  Loglikelihood unrestricted model (H1)     -27343.195  -27343.195
                                                                  
  Akaike (AIC)                               56285.750   56285.750
  Bayesian (BIC)                             56720.001   56720.001
  Sample-size adjusted Bayesian (SABIC)      56459.511   56459.511

Root Mean Square Error of Approximation:

  RMSEA                                          0.086       0.074
  90 Percent confidence interval - lower         0.082       0.070
  90 Percent confidence interval - upper         0.090       0.078
  P-value H_0: RMSEA &lt;= 0.050                    0.000       0.000
  P-value H_0: RMSEA &gt;= 0.080                    0.991       0.004
                                                                  
  Robust RMSEA                                               0.084
  90 Percent confidence interval - lower                     0.079
  90 Percent confidence interval - upper                     0.089
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.000
  P-value H_0: Robust RMSEA &gt;= 0.080                         0.902

Standardized Root Mean Square Residual:

  SRMR                                           0.057       0.057

Parameter Estimates:

  Standard errors                           Robust.sem
  Information                                 Expected
  Information saturated (h1) model          Structured


Group 1 [1]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  pa =~                                                                 
    pa1               1.000                               1.029    0.769
    pa2     (.p2.)    0.713    0.026   27.537    0.000    0.734    0.628
    pa3     (.p3.)    1.207    0.026   47.128    0.000    1.242    0.923
    pa4     (.p4.)    1.230    0.027   45.366    0.000    1.267    0.916
    pa5     (.p5.)    1.175    0.027   43.845    0.000    1.209    0.810
  pad =~                                                                
    pad1              1.000                               0.562    0.498
    pad2    (.p7.)    1.447    0.066   21.779    0.000    0.814    0.755
    pad3    (.p8.)    1.261    0.059   21.274    0.000    0.709    0.806
    pad4    (.p9.)    1.608    0.071   22.645    0.000    0.904    0.747
    pad5    (.10.)    1.433    0.068   21.020    0.000    0.806    0.839
  bc =~                                                                 
    bc1               1.000                               0.602    0.659
    bc2     (.12.)    1.837    0.093   19.829    0.000    1.106    0.892
    bc3     (.13.)    1.637    0.076   21.544    0.000    0.985    0.856
    bc4     (.14.)    1.412    0.066   21.415    0.000    0.850    0.734
    bc5     (.15.)    1.801    0.101   17.917    0.000    1.084    0.808
  ini =~                                                                
    Ini               1.000                               1.365    1.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  pa ~~                                                                 
    pad               0.151    0.025    5.974    0.000    0.261    0.261
    bc                0.010    0.028    0.358    0.720    0.016    0.016
    ini               0.307    0.054    5.649    0.000    0.218    0.218
  pad ~~                                                                
    bc               -0.142    0.021   -6.819    0.000   -0.419   -0.419
    ini              -0.171    0.034   -5.020    0.000   -0.223   -0.223
  bc ~~                                                                 
    ini               0.328    0.045    7.305    0.000    0.399    0.399

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .pa1     (.43.)    2.206    0.050   43.781    0.000    2.206    1.649
   .pa2     (.44.)    3.018    0.044   68.858    0.000    3.018    2.582
   .pa3     (.45.)    2.096    0.055   38.187    0.000    2.096    1.558
   .pa4     (.46.)    2.023    0.056   36.137    0.000    2.023    1.463
   .pa5     (.47.)    1.888    0.055   34.586    0.000    1.888    1.265
   .pad1    (.48.)    1.091    0.034   31.760    0.000    1.091    0.966
   .pad2    (.49.)    0.917    0.040   23.142    0.000    0.917    0.850
   .pad3    (.50.)    0.597    0.034   17.774    0.000    0.597    0.678
   .pad4    (.51.)    1.026    0.044   23.517    0.000    1.026    0.847
   .pad5    (.52.)    0.705    0.037   19.020    0.000    0.705    0.734
   .bc1     (.53.)    3.372    0.037   91.116    0.000    3.372    3.690
   .bc2     (.54.)    2.612    0.049   53.362    0.000    2.612    2.106
   .bc3     (.55.)    2.874    0.046   62.022    0.000    2.874    2.497
   .bc4     (.56.)    2.972    0.043   69.059    0.000    2.972    2.566
   .bc5     (.57.)    2.379    0.048   49.056    0.000    2.379    1.772
   .Ini     (.58.)    2.948    0.056   52.851    0.000    2.948    2.160
    pa                0.000                               0.000    0.000
    pad               0.000                               0.000    0.000
    bc                0.000                               0.000    0.000
    ini               0.000                               0.000    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .pa1               0.730    0.049   14.916    0.000    0.730    0.408
   .pa2               0.828    0.048   17.191    0.000    0.828    0.606
   .pa3               0.267    0.033    8.148    0.000    0.267    0.148
   .pa4               0.307    0.036    8.522    0.000    0.307    0.161
   .pa5               0.765    0.052   14.783    0.000    0.765    0.343
   .pad1              0.960    0.053   17.999    0.000    0.960    0.752
   .pad2              0.501    0.042   11.813    0.000    0.501    0.431
   .pad3              0.271    0.027   10.158    0.000    0.271    0.350
   .pad4              0.647    0.051   12.790    0.000    0.647    0.442
   .pad5              0.273    0.039    7.005    0.000    0.273    0.296
   .bc1               0.473    0.040   11.809    0.000    0.473    0.566
   .bc2               0.315    0.029   10.687    0.000    0.315    0.205
   .bc3               0.354    0.038    9.397    0.000    0.354    0.267
   .bc4               0.618    0.045   13.605    0.000    0.618    0.461
   .bc5               0.627    0.051   12.179    0.000    0.627    0.348
   .Ini               0.000                               0.000    0.000
    pa                1.060    0.063   16.788    0.000    1.000    1.000
    pad               0.316    0.037    8.664    0.000    1.000    1.000
    bc                0.362    0.042    8.590    0.000    1.000    1.000
    ini               1.864    0.095   19.669    0.000    1.000    1.000


Group 2 [0]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  pa =~                                                                 
    pa1               1.000                               0.965    0.795
    pa2     (.p2.)    0.713    0.026   27.537    0.000    0.688    0.713
    pa3     (.p3.)    1.207    0.026   47.128    0.000    1.165    0.946
    pa4     (.p4.)    1.230    0.027   45.366    0.000    1.188    0.929
    pa5     (.p5.)    1.175    0.027   43.845    0.000    1.134    0.831
  pad =~                                                                
    pad1              1.000                               0.629    0.585
    pad2    (.p7.)    1.447    0.066   21.779    0.000    0.911    0.833
    pad3    (.p8.)    1.261    0.059   21.274    0.000    0.793    0.880
    pad4    (.p9.)    1.608    0.071   22.645    0.000    1.012    0.841
    pad5    (.10.)    1.433    0.068   21.020    0.000    0.902    0.890
  bc =~                                                                 
    bc1               1.000                               0.470    0.694
    bc2     (.12.)    1.837    0.093   19.829    0.000    0.863    0.857
    bc3     (.13.)    1.637    0.076   21.544    0.000    0.769    0.862
    bc4     (.14.)    1.412    0.066   21.415    0.000    0.663    0.750
    bc5     (.15.)    1.801    0.101   17.917    0.000    0.846    0.765
  ini =~                                                                
    Ini               1.000                               0.699    1.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  pa ~~                                                                 
    pad              -0.011    0.018   -0.620    0.535   -0.018   -0.018
    bc                0.102    0.021    4.933    0.000    0.226    0.226
    ini               0.112    0.029    3.910    0.000    0.166    0.166
  pad ~~                                                                
    bc               -0.052    0.011   -4.775    0.000   -0.176   -0.176
    ini              -0.077    0.020   -3.891    0.000   -0.174   -0.174
  bc ~~                                                                 
    ini               0.119    0.025    4.775    0.000    0.362    0.362

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .pa1     (.43.)    2.206    0.050   43.781    0.000    2.206    1.817
   .pa2     (.44.)    3.018    0.044   68.858    0.000    3.018    3.130
   .pa3     (.45.)    2.096    0.055   38.187    0.000    2.096    1.702
   .pa4     (.46.)    2.023    0.056   36.137    0.000    2.023    1.583
   .pa5     (.47.)    1.888    0.055   34.586    0.000    1.888    1.383
   .pad1    (.48.)    1.091    0.034   31.760    0.000    1.091    1.014
   .pad2    (.49.)    0.917    0.040   23.142    0.000    0.917    0.839
   .pad3    (.50.)    0.597    0.034   17.774    0.000    0.597    0.662
   .pad4    (.51.)    1.026    0.044   23.517    0.000    1.026    0.853
   .pad5    (.52.)    0.705    0.037   19.020    0.000    0.705    0.696
   .bc1     (.53.)    3.372    0.037   91.116    0.000    3.372    4.981
   .bc2     (.54.)    2.612    0.049   53.362    0.000    2.612    2.593
   .bc3     (.55.)    2.874    0.046   62.022    0.000    2.874    3.221
   .bc4     (.56.)    2.972    0.043   69.059    0.000    2.972    3.362
   .bc5     (.57.)    2.379    0.048   49.056    0.000    2.379    2.150
   .Ini     (.58.)    2.948    0.056   52.851    0.000    2.948    4.215
    pa                0.761    0.057   13.407    0.000    0.789    0.789
    pad              -0.107    0.033   -3.195    0.001   -0.169   -0.169
    bc                0.378    0.035   10.912    0.000    0.805    0.805
    ini               0.840    0.059   14.131    0.000    1.201    1.201

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .pa1               0.542    0.036   14.908    0.000    0.542    0.368
   .pa2               0.457    0.027   17.093    0.000    0.457    0.491
   .pa3               0.159    0.020    7.808    0.000    0.159    0.105
   .pa4               0.223    0.033    6.660    0.000    0.223    0.136
   .pa5               0.577    0.050   11.450    0.000    0.577    0.310
   .pad1              0.761    0.052   14.571    0.000    0.761    0.658
   .pad2              0.365    0.037    9.888    0.000    0.365    0.306
   .pad3              0.183    0.022    8.243    0.000    0.183    0.226
   .pad4              0.423    0.035   12.071    0.000    0.423    0.293
   .pad5              0.213    0.027    7.884    0.000    0.213    0.207
   .bc1               0.238    0.025    9.525    0.000    0.238    0.519
   .bc2               0.270    0.028    9.639    0.000    0.270    0.266
   .bc3               0.205    0.022    9.173    0.000    0.205    0.258
   .bc4               0.341    0.025   13.656    0.000    0.341    0.437
   .bc5               0.508    0.035   14.315    0.000    0.508    0.415
   .Ini               0.000                               0.000    0.000
    pa                0.932    0.065   14.329    0.000    1.000    1.000
    pad               0.396    0.039   10.133    0.000    1.000    1.000
    bc                0.221    0.031    7.180    0.000    1.000    1.000
    ini               0.489    0.065    7.564    0.000    1.000    1.000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>cfa.config <span class="sc">|&gt;</span> <span class="fu">fitMeasures</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                         npar                          fmin 
                       82.000                         0.487 
                        chisq                            df 
                     1435.360                       222.000 
                       pvalue                  chisq.scaled 
                        0.000                      1113.215 
                    df.scaled                 pvalue.scaled 
                      222.000                         0.000 
         chisq.scaling.factor                baseline.chisq 
                        1.289                     15718.522 
                  baseline.df               baseline.pvalue 
                      240.000                         0.000 
        baseline.chisq.scaled            baseline.df.scaled 
                    11918.321                       240.000 
       baseline.pvalue.scaled baseline.chisq.scaling.factor 
                        0.000                         1.319 
                          cfi                           tli 
                        0.922                         0.915 
                   cfi.scaled                    tli.scaled 
                        0.924                         0.917 
                   cfi.robust                    tli.robust 
                        0.925                         0.919 
                         nnfi                           rfi 
                        0.915                         0.901 
                          nfi                          pnfi 
                        0.909                         0.841 
                          ifi                           rni 
                        0.922                         0.922 
                  nnfi.scaled                    rfi.scaled 
                        0.917                         0.899 
                   nfi.scaled                   pnfi.scaled 
                        0.907                         0.839 
                   ifi.scaled                    rni.scaled 
                        0.924                         0.924 
                  nnfi.robust                    rni.robust 
                        0.919                         0.925 
                         logl             unrestricted.logl 
                   -28060.875                    -27343.195 
                          aic                           bic 
                    56285.750                     56720.001 
                       ntotal                          bic2 
                     1474.000                     56459.511 
                        rmsea                rmsea.ci.lower 
                        0.086                         0.082 
               rmsea.ci.upper                rmsea.ci.level 
                        0.090                         0.900 
                 rmsea.pvalue                rmsea.close.h0 
                        0.000                         0.050 
        rmsea.notclose.pvalue             rmsea.notclose.h0 
                        0.991                         0.080 
                 rmsea.scaled         rmsea.ci.lower.scaled 
                        0.074                         0.070 
        rmsea.ci.upper.scaled           rmsea.pvalue.scaled 
                        0.078                         0.000 
 rmsea.notclose.pvalue.scaled                  rmsea.robust 
                        0.004                         0.084 
        rmsea.ci.lower.robust         rmsea.ci.upper.robust 
                        0.079                         0.089 
          rmsea.pvalue.robust  rmsea.notclose.pvalue.robust 
                        0.000                         0.902 
                          rmr                    rmr_nomean 
                        0.068                         0.069 
                         srmr                  srmr_bentler 
                        0.057                         0.057 
          srmr_bentler_nomean                          crmr 
                        0.057                         0.056 
                  crmr_nomean                    srmr_mplus 
                        0.057                         0.060 
            srmr_mplus_nomean                         cn_05 
                        0.055                       265.697 
                        cn_01                           gfi 
                      282.313                         0.979 
                         agfi                          pgfi 
                        0.972                         0.715 
                          mfi                          ecvi 
                        0.663                         1.085 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>cfasem <span class="ot">&lt;-</span> <span class="fu">sem</span>(inimod,<span class="at">data=</span>gambling,<span class="at">group=</span><span class="st">"Gambled"</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lavaanPlot</span>(<span class="at">model=</span>cfasem,<span class="at">coefs =</span> <span class="cn">TRUE</span>, <span class="at">stand =</span> <span class="cn">TRUE</span>, <span class="at">sig =</span> <span class="fl">0.05</span>) <span class="ot">-&gt;</span> lp</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">save_png</span>(lp,<span class="st">"sem_ini.png"</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(cfasem,<span class="st">"std"</span>,<span class="at">layout=</span><span class="st">"tree"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GamblingAddiction_InstrumentValidation_files/figure-html/config-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="GamblingAddiction_InstrumentValidation_files/figure-html/config-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The results show that the fit is good between the groups. CFI and TLI are close to 1,and the SRMR is close to 0.8. The RMSEA is slightly higher than 0.06. We can conclude that the two groups have the same factor structure.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compareFit</span>(CFAfit_ini,cfa.config) <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>################### Nested Model Comparison #########################

Scaled Chi-Squared Difference Test (method = "satorra.bentler.2001")

lavaan NOTE:
    The "Chisq" column contains standard test statistics, not the
    robust test that should be reported per model. A robust difference
    test is a function of two standard (not robust) statistics.
 
            Df   AIC   BIC  Chisq Chisq diff Df diff Pr(&gt;Chisq)    
CFAfit_ini  99 57405 57685 1188.3                                  
cfa.config 222 56286 56720 1435.4     198.71     123  1.823e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

####################### Model Fit Indices ###########################
           chisq.scaled df.scaled pvalue.scaled rmsea.robust cfi.robust
CFAfit_ini     882.537†        99          .000        .085       .935†
cfa.config    1113.215        222          .000        .084†      .925 
           tli.robust  srmr        aic        bic
CFAfit_ini      .922† .054† 57404.716  57685.390 
cfa.config      .919  .057  56285.750† 56720.001†

################## Differences in Fit Indices #######################
                        df.scaled rmsea.robust cfi.robust tli.robust  srmr
cfa.config - CFAfit_ini       123       -0.001      -0.01     -0.002 0.003
                              aic     bic
cfa.config - CFAfit_ini -1118.966 -965.39</code></pre>
</div>
</div>
<p>We can compare this result with the model that does not consider groups. The AIC and BIC are significantly lower than the general model, which means the model that accounts for the recently gambled grouping performs better. Bear in mind that even if the CFI and TLI slightly decreased, it did not decrease significantly. The same can be said about the RMSEA and SRMR.</p>
<section id="construct-validity" class="level3">
<h3 class="anchored" data-anchor-id="construct-validity">Construct validity</h3>
<p>We now check validity through CR and AVE for the model with groupings:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>cfa.config <span class="sc">|&gt;</span> <span class="fu">compRelSEM</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  group    pa   pad    bc
1     1 0.936 0.820 0.906
2     0 0.916 0.918 0.879</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>cfa.config <span class="sc">|&gt;</span> semTools<span class="sc">::</span><span class="fu">reliability</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`
              pa       pad        bc
alpha  0.9027377 0.8529072 0.8924518
omega  0.9120156 0.8445193 0.8997432
omega2 0.9120156 0.8445193 0.8997432
omega3 0.9357924 0.8198547 0.9057177
avevar 0.6817116 0.5264624 0.6511756

$`0`
              pa       pad        bc
alpha  0.9286513 0.8969229 0.8840554
omega  0.9310100 0.9025939 0.8929531
omega2 0.9310100 0.9025939 0.8929531
omega3 0.9158805 0.9180497 0.8792080
avevar 0.7360347 0.6547729 0.6343916</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>cfa.config <span class="sc">|&gt;</span> <span class="fu">AVE</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  group    pa   pad    bc
1     1 0.696 0.528 0.659
2     0 0.736 0.665 0.625</code></pre>
</div>
</div>
<!-- ## Metric Invariance -->
<!-- Now we are testing metric invariance, which sets the loadings to be equal. We then compare the fit between the configural and metric assumptions. -->
<!-- ```{r,metric} -->
<!-- cfa.metric <- cfa(inimod,data=gambling,group="Gambled",group.equal="loadings",estimator="MLM") -->
<!-- cfa.metric |> summary(fit.measures=T) -->
<!-- # cfa.metric |> fitmeasures() -->
<!-- # lavInspect(cfa.metric, -->
<!-- # "options")[c("estimator","test","meanstructure")] -->
<!-- #  -->
<!-- # lavInspect(cfa.config, -->
<!-- # "options")[c("estimator","test","meanstructure")] -->
<!-- compareFit(cfa.config,cfa.metric) |> summary() -->
<!-- ``` -->
<!-- Results show that the chi-square test is significant, which means that the metric invariance is not satisfied. This means that even if the groups have the same factor structures, the factor loadings are different across groups. This is understandable based on the nature of grouping (problem vs non-problem gamblers). There must be different sense of importance in their attitude towards quitting gambling. -->
<!-- ```{r, lavtestscore} -->
<!-- lavTestScore(cfa.config) -->
<!-- ``` -->

<!-- The significant score tests shows which questions between groups have different loadings. We can look at which relations/loadings are significantly different in the table below. -->
<!-- ```{r,parameters} -->

<!-- parTable(cfa.config) -->
<!-- ``` -->
</section>
</section>
<section id="sustenance-of-quitting-gambling" class="level2">
<h2 class="anchored" data-anchor-id="sustenance-of-quitting-gambling">Sustenance of quitting gambling</h2>
<p>We now check for correlations between the items for sustenance of quitting gambling.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a> cormat <span class="ot">&lt;-</span> gambling <span class="sc">|&gt;</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="fu">c</span>(<span class="st">"et"</span>,<span class="st">"pfc"</span>,<span class="st">"cse"</span>,<span class="st">"Sus"</span>),<span class="at">ignore.case=</span>F)) <span class="sc">|&gt;</span>   <span class="fu">cor</span>()</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">corrplot</span>(cormat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GamblingAddiction_InstrumentValidation_files/figure-html/corrsus-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We now use the <code>lavaan</code> package to estimate a multi-group CFA by grouping each construct.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>susmod <span class="ot">&lt;-</span> <span class="st">'et =~ et1 + et2 + et3</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="st">                pfc =~ pfc1 + pfc2 + pfc3</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="st">                cse =~ cse1 + cse2 + cse3</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="st">                sus=~ Sus'</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>CFAfit <span class="ot">&lt;-</span> <span class="fu">cfa</span>(susmod,<span class="at">data=</span>gambling,<span class="at">estimator=</span><span class="st">"MLM"</span>)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>CFAfit <span class="sc">|&gt;</span> <span class="fu">summary</span>(<span class="at">fit.measures=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.15 ended normally after 42 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        25

  Number of observations                          1474

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                               162.262     101.075
  Degrees of freedom                                30          30
  P-value (Chi-square)                           0.000       0.000
  Scaling correction factor                                  1.605
    Satorra-Bentler correction                                    

Model Test Baseline Model:

  Test statistic                              9555.290    4740.691
  Degrees of freedom                                45          45
  P-value                                        0.000       0.000
  Scaling correction factor                                  2.016

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.986       0.985
  Tucker-Lewis Index (TLI)                       0.979       0.977
                                                                  
  Robust Comparative Fit Index (CFI)                         0.988
  Robust Tucker-Lewis Index (TLI)                            0.982

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -17740.238  -17740.238
  Loglikelihood unrestricted model (H1)     -17659.107  -17659.107
                                                                  
  Akaike (AIC)                               35530.477   35530.477
  Bayesian (BIC)                             35662.870   35662.870
  Sample-size adjusted Bayesian (SABIC)      35583.453   35583.453

Root Mean Square Error of Approximation:

  RMSEA                                          0.055       0.040
  90 Percent confidence interval - lower         0.047       0.033
  90 Percent confidence interval - upper         0.063       0.047
  P-value H_0: RMSEA &lt;= 0.050                    0.165       0.992
  P-value H_0: RMSEA &gt;= 0.080                    0.000       0.000
                                                                  
  Robust RMSEA                                               0.051
  90 Percent confidence interval - lower                     0.040
  90 Percent confidence interval - upper                     0.062
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.432
  P-value H_0: Robust RMSEA &gt;= 0.080                         0.000

Standardized Root Mean Square Residual:

  SRMR                                           0.031       0.031

Parameter Estimates:

  Standard errors                           Robust.sem
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  et =~                                               
    et1               1.000                           
    et2               0.936    0.024   39.158    0.000
    et3               0.940    0.026   36.749    0.000
  pfc =~                                              
    pfc1              1.000                           
    pfc2              0.998    0.033   30.323    0.000
    pfc3              0.970    0.033   29.328    0.000
  cse =~                                              
    cse1              1.000                           
    cse2              0.991    0.033   29.736    0.000
    cse3              0.800    0.036   22.277    0.000
  sus =~                                              
    Sus               1.000                           

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  et ~~                                               
    pfc               0.650    0.041   15.830    0.000
    cse               0.509    0.040   12.858    0.000
    sus               0.556    0.041   13.671    0.000
  pfc ~~                                              
    cse               0.549    0.040   13.786    0.000
    sus               0.518    0.040   12.928    0.000
  cse ~~                                              
    sus               0.367    0.046    7.919    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .et1               0.259    0.026    9.930    0.000
   .et2               0.117    0.015    7.769    0.000
   .et3               0.152    0.017    9.096    0.000
   .pfc1              0.845    0.057   14.941    0.000
   .pfc2              0.160    0.017    9.150    0.000
   .pfc3              0.295    0.032    9.223    0.000
   .cse1              0.458    0.045   10.145    0.000
   .cse2              0.322    0.043    7.425    0.000
   .cse3              1.169    0.062   18.797    0.000
   .Sus               0.000                           
    et                0.762    0.048   15.732    0.000
    pfc               0.751    0.052   14.473    0.000
    cse               1.062    0.066   16.189    0.000
    sus               2.146    0.058   36.768    0.000</code></pre>
</div>
</div>
<p>All fit measures indicate a good fit, with the CLI close to 1, RMSEA &lt; 0.06, and SRMR &lt; 0.05.</p>
</section>
<section id="construct-validity-convergent-and-discriminant-validity-1" class="level2">
<h2 class="anchored" data-anchor-id="construct-validity-convergent-and-discriminant-validity-1">Construct Validity (Convergent and Discriminant Validity)</h2>
<p>We check convergent and discriminant validity by looking at the AVE (average variance extracted) for convergent validity and CR (composite reliability) for discriminant validity.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>CFAfit <span class="sc">|&gt;</span> <span class="fu">compRelSEM</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   et   pfc   cse 
0.924 0.838 0.813 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>CFAfit <span class="sc">|&gt;</span> semTools<span class="sc">::</span><span class="fu">reliability</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              et       pfc       cse
alpha  0.9215844 0.8341404 0.8023436
omega  0.9227681 0.8359028 0.8093057
omega2 0.9227681 0.8359028 0.8093057
omega3 0.9239706 0.8380182 0.8128010
avevar 0.7994544 0.6293982 0.5882261</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>CFAfit <span class="sc">|&gt;</span> <span class="fu">AVE</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   et   pfc   cse 
0.799 0.629 0.588 </code></pre>
</div>
</div>
</section>
<section id="configural-invariance-1" class="level2">
<h2 class="anchored" data-anchor-id="configural-invariance-1">Configural Invariance</h2>
<p>Let us now see if we have configural invariance between the non-gambling and gambling groups.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>cfa.config <span class="ot">&lt;-</span> <span class="fu">cfa</span>(susmod,<span class="at">data=</span>gambling,<span class="at">group=</span><span class="st">"Gambled"</span>,<span class="at">mimic=</span><span class="st">"Mplus"</span>,</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">estimator=</span><span class="st">"MLM"</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>cfa.config <span class="sc">|&gt;</span> <span class="fu">summary</span>(<span class="at">fit.measures=</span>T,<span class="at">standardized=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.15 ended normally after 83 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        74
  Number of equality constraints                    16

  Number of observations per group:                   
    1                                              562
    0                                              912

Model Test User Model:
                                               Standard      Scaled
  Test Statistic                                224.813     150.005
  Degrees of freedom                                 72          72
  P-value (Chi-square)                            0.000       0.000
  Scaling correction factor                                   1.499
    Satorra-Bentler correction (Mplus variant)                     
  Test statistic for each group:
    1                                           70.579      47.093
    0                                          154.234     102.912

Model Test Baseline Model:

  Test statistic                              9174.009    5903.822
  Degrees of freedom                                90          90
  P-value                                        0.000       0.000
  Scaling correction factor                                  1.554

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.983       0.987
  Tucker-Lewis Index (TLI)                       0.979       0.983
                                                                  
  Robust Comparative Fit Index (CFI)                         0.987
  Robust Tucker-Lewis Index (TLI)                            0.984

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -17350.743  -17350.743
  Loglikelihood unrestricted model (H1)     -17238.337  -17238.337
                                                                  
  Akaike (AIC)                               34817.486   34817.486
  Bayesian (BIC)                             35124.639   35124.639
  Sample-size adjusted Bayesian (SABIC)      34940.391   34940.391

Root Mean Square Error of Approximation:

  RMSEA                                          0.054       0.038
  90 Percent confidence interval - lower         0.046       0.031
  90 Percent confidence interval - upper         0.062       0.045
  P-value H_0: RMSEA &lt;= 0.050                    0.215       0.997
  P-value H_0: RMSEA &gt;= 0.080                    0.000       0.000
                                                                  
  Robust RMSEA                                               0.047
  90 Percent confidence interval - lower                     0.036
  90 Percent confidence interval - upper                     0.058
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.670
  P-value H_0: Robust RMSEA &gt;= 0.080                         0.000

Standardized Root Mean Square Residual:

  SRMR                                           0.038       0.038

Parameter Estimates:

  Standard errors                           Robust.sem
  Information                                 Expected
  Information saturated (h1) model          Structured


Group 1 [1]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  et =~                                                                 
    et1               1.000                               1.032    0.874
    et2     (.p2.)    0.926    0.024   38.143    0.000    0.955    0.926
    et3     (.p3.)    0.930    0.026   35.252    0.000    0.960    0.899
  pfc =~                                                                
    pfc1              1.000                               0.958    0.708
    pfc2    (.p5.)    0.996    0.031   31.715    0.000    0.954    0.895
    pfc3    (.p6.)    0.962    0.033   29.434    0.000    0.921    0.832
  cse =~                                                                
    cse1              1.000                               1.085    0.826
    cse2    (.p8.)    0.994    0.032   31.011    0.000    1.079    0.894
    cse3    (.p9.)    0.804    0.035   22.661    0.000    0.872    0.620
  sus =~                                                                
    Sus               1.000                               1.476    1.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  et ~~                                                                 
    pfc               0.840    0.065   12.976    0.000    0.850    0.850
    cse               0.664    0.066   10.008    0.000    0.593    0.593
    sus               0.445    0.064    6.926    0.000    0.292    0.292
  pfc ~~                                                                
    cse               0.655    0.063   10.390    0.000    0.630    0.630
    sus               0.358    0.061    5.864    0.000    0.254    0.254
  cse ~~                                                                
    sus               0.167    0.072    2.330    0.020    0.105    0.105

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .et1     (.31.)    3.044    0.046   66.468    0.000    3.044    2.578
   .et2     (.32.)    3.205    0.044   73.484    0.000    3.205    3.107
   .et3     (.33.)    3.183    0.044   72.035    0.000    3.183    2.981
   .pfc1    (.34.)    2.851    0.048   59.255    0.000    2.851    2.106
   .pfc2    (.35.)    3.135    0.044   71.880    0.000    3.135    2.941
   .pfc3    (.36.)    3.112    0.044   70.577    0.000    3.112    2.813
   .cse1    (.37.)    2.992    0.052   57.415    0.000    2.992    2.277
   .cse2    (.38.)    3.001    0.050   60.486    0.000    3.001    2.488
   .cse3    (.39.)    2.717    0.047   57.408    0.000    2.717    1.931
   .Sus     (.40.)    1.781    0.062   28.730    0.000    1.781    1.207
    et                0.000                               0.000    0.000
    pfc               0.000                               0.000    0.000
    cse               0.000                               0.000    0.000
    sus               0.000                               0.000    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .et1               0.329    0.043    7.733    0.000    0.329    0.236
   .et2               0.152    0.027    5.739    0.000    0.152    0.143
   .et3               0.219    0.029    7.481    0.000    0.219    0.192
   .pfc1              0.914    0.087   10.525    0.000    0.914    0.499
   .pfc2              0.227    0.029    7.912    0.000    0.227    0.199
   .pfc3              0.376    0.060    6.255    0.000    0.376    0.307
   .cse1              0.549    0.074    7.378    0.000    0.549    0.318
   .cse2              0.291    0.059    4.916    0.000    0.291    0.200
   .cse3              1.220    0.097   12.616    0.000    1.220    0.616
   .Sus               0.000                               0.000    0.000
    et                1.064    0.080   13.347    0.000    1.000    1.000
    pfc               0.918    0.078   11.836    0.000    1.000    1.000
    cse               1.177    0.089   13.155    0.000    1.000    1.000
    sus               2.178    0.072   30.343    0.000    1.000    1.000


Group 2 [0]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  et =~                                                                 
    et1               1.000                               0.706    0.835
    et2     (.p2.)    0.926    0.024   38.143    0.000    0.653    0.905
    et3     (.p3.)    0.930    0.026   35.252    0.000    0.657    0.892
  pfc =~                                                                
    pfc1              1.000                               0.776    0.655
    pfc2    (.p5.)    0.996    0.031   31.715    0.000    0.773    0.914
    pfc3    (.p6.)    0.962    0.033   29.434    0.000    0.746    0.833
  cse =~                                                                
    cse1              1.000                               0.975    0.838
    cse2    (.p8.)    0.994    0.032   31.011    0.000    0.969    0.857
    cse3    (.p9.)    0.804    0.035   22.661    0.000    0.783    0.592
  sus =~                                                                
    Sus               1.000                               1.178    1.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  et ~~                                                                 
    pfc               0.472    0.049    9.693    0.000    0.861    0.861
    cse               0.361    0.045    8.060    0.000    0.524    0.524
    sus               0.364    0.044    8.284    0.000    0.438    0.438
  pfc ~~                                                                
    cse               0.440    0.045    9.752    0.000    0.581    0.581
    sus               0.419    0.044    9.521    0.000    0.458    0.458
  cse ~~                                                                
    sus               0.337    0.051    6.628    0.000    0.294    0.294

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .et1     (.31.)    3.044    0.046   66.468    0.000    3.044    3.600
   .et2     (.32.)    3.205    0.044   73.484    0.000    3.205    4.439
   .et3     (.33.)    3.183    0.044   72.035    0.000    3.183    4.322
   .pfc1    (.34.)    2.851    0.048   59.255    0.000    2.851    2.407
   .pfc2    (.35.)    3.135    0.044   71.880    0.000    3.135    3.707
   .pfc3    (.36.)    3.112    0.044   70.577    0.000    3.112    3.473
   .cse1    (.37.)    2.992    0.052   57.415    0.000    2.992    2.571
   .cse2    (.38.)    3.001    0.050   60.486    0.000    3.001    2.655
   .cse3    (.39.)    2.717    0.047   57.408    0.000    2.717    2.053
   .Sus     (.40.)    1.781    0.062   28.730    0.000    1.781    1.512
    et                0.503    0.051    9.899    0.000    0.713    0.713
    pfc               0.378    0.051    7.355    0.000    0.487    0.487
    cse               0.279    0.061    4.611    0.000    0.286    0.286
    sus               1.391    0.073   19.036    0.000    1.181    1.181

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .et1               0.216    0.030    7.099    0.000    0.216    0.303
   .et2               0.094    0.014    6.723    0.000    0.094    0.181
   .et3               0.111    0.017    6.418    0.000    0.111    0.204
   .pfc1              0.800    0.062   12.961    0.000    0.800    0.570
   .pfc2              0.118    0.019    6.194    0.000    0.118    0.165
   .pfc3              0.246    0.034    7.287    0.000    0.246    0.306
   .cse1              0.404    0.049    8.265    0.000    0.404    0.298
   .cse2              0.339    0.053    6.436    0.000    0.339    0.265
   .cse3              1.138    0.073   15.546    0.000    1.138    0.650
   .Sus               0.000                               0.000    0.000
    et                0.499    0.053    9.323    0.000    1.000    1.000
    pfc               0.602    0.055   10.886    0.000    1.000    1.000
    cse               0.950    0.072   13.262    0.000    1.000    1.000
    sus               1.388    0.080   17.340    0.000    1.000    1.000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>cfasem <span class="ot">&lt;-</span> <span class="fu">sem</span>(susmod,<span class="at">data=</span>gambling,<span class="at">group=</span><span class="st">"Gambled"</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lavaanPlot</span>(<span class="at">model=</span>cfasem,<span class="at">coefs =</span> <span class="cn">TRUE</span>, <span class="at">stand =</span> <span class="cn">TRUE</span>, <span class="at">sig =</span> <span class="fl">0.05</span>) <span class="ot">-&gt;</span> lp_sus</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">save_png</span>(lp_sus,<span class="st">"sem_sus.png"</span>)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(cfasem,<span class="st">"std"</span>,<span class="at">layout=</span><span class="st">"tree"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GamblingAddiction_InstrumentValidation_files/figure-html/configsus-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="GamblingAddiction_InstrumentValidation_files/figure-html/configsus-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The fit still remains acceptable after including groups, which means that both groups have the same factors in their model.</p>
<section id="construct-validity-1" class="level3">
<h3 class="anchored" data-anchor-id="construct-validity-1">Construct Validity</h3>
<p>We now check validity through CR and AVE for the model with groupings:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>cfa.config <span class="sc">|&gt;</span> <span class="fu">compRelSEM</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  group    et  pfc   cse
1     1 0.940 0.85 0.829
2     0 0.896 0.81 0.796</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>cfa.config <span class="sc">|&gt;</span> semTools<span class="sc">::</span><span class="fu">reliability</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`
              et       pfc       cse
alpha  0.9238064 0.8385190 0.8067198
omega  0.9253484 0.8410702 0.8172798
omega2 0.9253484 0.8410702 0.8172798
omega3 0.9401681 0.8504862 0.8289934
avevar 0.8053386 0.6382792 0.6008344

$`0`
              et       pfc       cse
alpha  0.9054528 0.8191770 0.7941791
omega  0.9060441 0.8190452 0.7980944
omega2 0.9060441 0.8190452 0.7980944
omega3 0.8958845 0.8099514 0.7955887
avevar 0.7629509 0.6014673 0.5708559</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>cfa.config <span class="sc">|&gt;</span> <span class="fu">AVE</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  group    et   pfc   cse
1     1 0.817 0.643 0.604
2     0 0.754 0.595 0.569</code></pre>
</div>
</div>
<!-- ## Metric Invariance -->
<!-- Now we are testing metric invariance, which sets the loadings to be equal. We then compare the fit between the configural and metric assumptions. -->
<!-- ```{r,metricsus} -->
<!-- cfa.metric <- cfa(susmod,data=gambling,group="Gambled",group.equal="loadings",estimator="MLM") -->
<!-- compareFit(cfa.config,cfa.metric) |> summary() -->
<!-- ``` -->
<!-- Results show that the chi-square test is not significant, which means that the metric invariance is satisfied. The new model where we constrained the loadings to be equal for both groups does not differ in terms of performance. This means that the two groups have the same factors and factor loadings.  -->
<!-- ## Scalar Invariance (strong invariance) -->
<!-- For scalar invariance, we also set the intercepts to be equal. -->
<!-- ```{r, scalarsus} -->
<!-- # Scalar model -->
<!-- cfa.scalar <- cfa(susmod, data = gambling,  -->
<!--                   estimator="MLM",group = "Gambled", group.equal = c("loadings","intercepts")) -->
<!-- cfa.scalar |> summary(fit.measures=T) -->
<!-- # Model comparison -->
<!-- compareFit(cfa.metric, cfa.scalar) |> summary() -->
<!-- ``` -->
<!-- There is no significant difference in chi-square values as well as the other fit measures, which means that the constructs in the sustenance aspect of quitting gambling is also scalar invariant.  -->
</section>
</section>
<section id="t-test-for-different-items" class="level2">
<h2 class="anchored" data-anchor-id="t-test-for-different-items">T-test for different items</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>gambling <span class="sc">|&gt;</span> </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize_at</span>(<span class="fu">vars</span>(pa1<span class="sc">:</span>Sus),</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>               <span class="fu">list</span>(<span class="at">pvalue=</span><span class="sc">~</span><span class="fu">t.test</span>(.<span class="sc">~</span>Gambled)<span class="sc">$</span>p.value)) <span class="sc">|&gt;</span> </span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">ends_with</span>(<span class="st">"value"</span>),</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Item"</span>,</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"p.value"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value=</span><span class="fu">round</span>(p.value,<span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Item p.value
1   pa1_pvalue   0.000
2   pa2_pvalue   0.000
3   pa3_pvalue   0.000
4   pa4_pvalue   0.000
5   pa5_pvalue   0.000
6    PA_pvalue   0.000
7  pad1_pvalue   0.000
8  pad2_pvalue   0.000
9  pad3_pvalue   0.398
10 pad4_pvalue   0.000
11 pad5_pvalue   0.698
12  PAD_pvalue   0.000
13   PD_pvalue   0.000
14  bc1_pvalue   0.000
15  bc2_pvalue   0.000
16  bc3_pvalue   0.000
17  bc4_pvalue   0.000
18  bc5_pvalue   0.000
19   BC_pvalue   0.000
20 cpe1_pvalue   0.126
21 cpe2_pvalue   0.000
22 cpe3_pvalue   0.000
23  CPE_pvalue   0.000
24  et1_pvalue   0.000
25  et2_pvalue   0.000
26  et3_pvalue   0.000
27   ET_pvalue   0.000
28 pfc1_pvalue   0.000
29 pfc2_pvalue   0.000
30 pfc3_pvalue   0.000
31  PfC_pvalue   0.000
32 cse1_pvalue   0.000
33 cse2_pvalue   0.000
34 cse3_pvalue   0.001
35  CSE_pvalue   0.000
36  Ini_pvalue   0.000
37  Sus_pvalue   0.000</code></pre>
</div>
</div>
</section>
<section id="conclusions" class="level2">
<h2 class="anchored" data-anchor-id="conclusions">Conclusions</h2>
<p>We have established scalar invariance of the construct validity in the sustenance response, which means the factor loadings and intercepts are the same for those who did and did not gamble in the past 30 days. This invariance was not observed in the initiation to quit gambling.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>